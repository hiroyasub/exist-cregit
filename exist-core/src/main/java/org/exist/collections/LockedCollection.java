begin_unit|revision:1.0.0;language:Java;cregit-version:0.0.1
begin_comment
comment|/*  * eXist Open Source Native XML Database  * Copyright (C) 2001-2017 The eXist Project  * http://exist-db.org  *  * This program is free software; you can redistribute it and/or  * modify it under the terms of the GNU Lesser General Public License  * as published by the Free Software Foundation; either version 2  * of the License, or (at your option) any later version.  *  * This program is distributed in the hope that it will be useful,  * but WITHOUT ANY WARRANTY; without even the implied warranty of  * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the  * GNU Lesser General Public License for more details.  *  * You should have received a copy of the GNU Lesser General Public  * License along with this library; if not, write to the Free Software  * Foundation, Inc., 51 Franklin St, Fifth Floor, Boston, MA  02110-1301  USA  */
end_comment

begin_package
package|package
name|org
operator|.
name|exist
operator|.
name|collections
package|;
end_package

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|EXistException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|collections
operator|.
name|triggers
operator|.
name|TriggerException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|dom
operator|.
name|QName
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|dom
operator|.
name|persistent
operator|.
name|*
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|security
operator|.
name|Permission
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|security
operator|.
name|PermissionDeniedException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|security
operator|.
name|Subject
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|storage
operator|.
name|*
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|storage
operator|.
name|io
operator|.
name|VariableByteOutputStream
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|storage
operator|.
name|lock
operator|.
name|Lock
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|storage
operator|.
name|lock
operator|.
name|LockedDocumentMap
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|storage
operator|.
name|lock
operator|.
name|ManagedCollectionLock
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|storage
operator|.
name|txn
operator|.
name|Txn
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|util
operator|.
name|LockException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|exist
operator|.
name|xmldb
operator|.
name|XmldbURI
import|;
end_import

begin_import
import|import
name|org
operator|.
name|w3c
operator|.
name|dom
operator|.
name|Node
import|;
end_import

begin_import
import|import
name|org
operator|.
name|xml
operator|.
name|sax
operator|.
name|InputSource
import|;
end_import

begin_import
import|import
name|org
operator|.
name|xml
operator|.
name|sax
operator|.
name|SAXException
import|;
end_import

begin_import
import|import
name|org
operator|.
name|xml
operator|.
name|sax
operator|.
name|XMLReader
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|IOException
import|;
end_import

begin_import
import|import
name|java
operator|.
name|io
operator|.
name|InputStream
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Date
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Iterator
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|List
import|;
end_import

begin_import
import|import
name|java
operator|.
name|util
operator|.
name|Observable
import|;
end_import

begin_comment
comment|/**  * Just a Delegate to a {@link Collection} which allows us to also hold a lock  * lease which is released when {@link Collection#close()} is called. This  * allows us to use ARM (Automatic Resource Management) e.g. try-with-resources  * with eXist Collection objects  *  * @author Adam Retter<adam@evolvedbinary.com>  */
end_comment

begin_class
specifier|public
class|class
name|LockedCollection
implements|implements
name|Collection
block|{
specifier|private
specifier|final
name|ManagedCollectionLock
name|managedCollectionLock
decl_stmt|;
specifier|private
specifier|final
name|Collection
name|collection
decl_stmt|;
specifier|public
name|LockedCollection
parameter_list|(
specifier|final
name|ManagedCollectionLock
name|managedCollectionLock
parameter_list|,
specifier|final
name|Collection
name|collection
parameter_list|)
block|{
name|this
operator|.
name|managedCollectionLock
operator|=
name|managedCollectionLock
expr_stmt|;
name|this
operator|.
name|collection
operator|=
name|collection
expr_stmt|;
block|}
comment|//TODO(AR) if we decide that LockedCollection shouldn't implement Collection (but instead become a Tuple2<ManagedCollectionLock, Collection>) then drop this method
comment|/**      * Given a Collection implementation returns the non-lock wrapped      * implementation.      *      * @param collection a Collection object.      * @return the actual non-lock wrapped Collection object.      */
specifier|public
specifier|static
name|Collection
name|unwrapLocked
parameter_list|(
specifier|final
name|Collection
name|collection
parameter_list|)
block|{
comment|//TODO(AR) do we want to stay with LockedCollection implements Collection design {@link LockedCollection#getCollection()}
if|if
condition|(
name|collection
operator|instanceof
name|LockedCollection
condition|)
block|{
comment|// unwrap the locked collection
return|return
operator|(
operator|(
name|LockedCollection
operator|)
name|collection
operator|)
operator|.
name|collection
return|;
block|}
else|else
block|{
return|return
name|collection
return|;
block|}
block|}
comment|/**      * Unlocks and Closes the Collection      */
annotation|@
name|Override
specifier|public
name|void
name|close
parameter_list|()
block|{
name|collection
operator|.
name|close
argument_list|()
expr_stmt|;
name|managedCollectionLock
operator|.
name|close
argument_list|()
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|int
name|getId
parameter_list|()
block|{
return|return
name|collection
operator|.
name|getId
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|setId
parameter_list|(
specifier|final
name|int
name|id
parameter_list|)
block|{
name|collection
operator|.
name|setId
argument_list|(
name|id
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|XmldbURI
name|getURI
parameter_list|()
block|{
return|return
name|collection
operator|.
name|getURI
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|setPath
parameter_list|(
specifier|final
name|XmldbURI
name|path
parameter_list|)
block|{
name|collection
operator|.
name|setPath
argument_list|(
name|path
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|CollectionMetadata
name|getMetadata
parameter_list|()
block|{
return|return
name|collection
operator|.
name|getMetadata
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|Permission
name|getPermissions
parameter_list|()
block|{
return|return
name|collection
operator|.
name|getPermissions
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|Permission
name|getPermissionsNoLock
parameter_list|()
block|{
return|return
name|collection
operator|.
name|getPermissionsNoLock
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|setPermissions
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|int
name|mode
parameter_list|)
throws|throws
name|LockException
throws|,
name|PermissionDeniedException
block|{
name|collection
operator|.
name|setPermissions
argument_list|(
name|broker
argument_list|,
name|mode
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
annotation|@
name|Deprecated
specifier|public
name|long
name|getCreationTime
parameter_list|()
block|{
return|return
name|collection
operator|.
name|getCreationTime
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|setCreationTime
parameter_list|(
specifier|final
name|long
name|timestamp
parameter_list|)
block|{
name|collection
operator|.
name|setCreationTime
argument_list|(
name|timestamp
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|CollectionConfiguration
name|getConfiguration
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
block|{
return|return
name|collection
operator|.
name|getConfiguration
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|IndexSpec
name|getIndexConfiguration
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
block|{
return|return
name|collection
operator|.
name|getIndexConfiguration
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|GeneralRangeIndexSpec
name|getIndexByPathConfiguration
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|NodePath
name|nodePath
parameter_list|)
block|{
return|return
name|collection
operator|.
name|getIndexByPathConfiguration
argument_list|(
name|broker
argument_list|,
name|nodePath
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|QNameRangeIndexSpec
name|getIndexByQNameConfiguration
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|QName
name|nodeName
parameter_list|)
block|{
return|return
name|collection
operator|.
name|getIndexByQNameConfiguration
argument_list|(
name|broker
argument_list|,
name|nodeName
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isTempCollection
parameter_list|()
block|{
return|return
name|collection
operator|.
name|isTempCollection
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|int
name|getMemorySize
parameter_list|()
block|{
return|return
name|collection
operator|.
name|getMemorySize
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|int
name|getMemorySizeNoLock
parameter_list|()
block|{
return|return
name|collection
operator|.
name|getMemorySizeNoLock
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|XmldbURI
name|getParentURI
parameter_list|()
block|{
return|return
name|collection
operator|.
name|getParentURI
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|isEmpty
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|isEmpty
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|int
name|getDocumentCount
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|getDocumentCount
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
annotation|@
name|Deprecated
specifier|public
name|int
name|getDocumentCountNoLock
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|getDocumentCountNoLock
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|int
name|getChildCollectionCount
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|getChildCollectionCount
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasDocument
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|hasDocument
argument_list|(
name|broker
argument_list|,
name|name
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|boolean
name|hasChildCollection
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
block|{
return|return
name|collection
operator|.
name|hasChildCollection
argument_list|(
name|broker
argument_list|,
name|name
argument_list|)
return|;
block|}
annotation|@
name|Override
annotation|@
name|Deprecated
specifier|public
name|boolean
name|hasChildCollectionNoLock
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|hasChildCollectionNoLock
argument_list|(
name|broker
argument_list|,
name|name
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|addCollection
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|Collection
name|child
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
block|{
name|collection
operator|.
name|addCollection
argument_list|(
name|broker
argument_list|,
name|child
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|List
argument_list|<
name|CollectionEntry
argument_list|>
name|getEntries
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|getEntries
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|CollectionEntry
name|getChildCollectionEntry
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|String
name|name
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|getChildCollectionEntry
argument_list|(
name|broker
argument_list|,
name|name
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|CollectionEntry
name|getResourceEntry
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|String
name|name
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|getResourceEntry
argument_list|(
name|broker
argument_list|,
name|name
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|update
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|Collection
name|child
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
block|{
name|collection
operator|.
name|update
argument_list|(
name|broker
argument_list|,
name|child
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|addDocument
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|DocumentImpl
name|doc
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
block|{
name|collection
operator|.
name|addDocument
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|doc
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|unlinkDocument
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|DocumentImpl
name|doc
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
block|{
name|collection
operator|.
name|unlinkDocument
argument_list|(
name|broker
argument_list|,
name|doc
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|Iterator
argument_list|<
name|XmldbURI
argument_list|>
name|collectionIterator
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
block|{
return|return
name|collection
operator|.
name|collectionIterator
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
annotation|@
name|Deprecated
specifier|public
name|Iterator
argument_list|<
name|XmldbURI
argument_list|>
name|collectionIteratorNoLock
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|collectionIteratorNoLock
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|Iterator
argument_list|<
name|DocumentImpl
argument_list|>
name|iterator
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
block|{
return|return
name|collection
operator|.
name|iterator
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
annotation|@
name|Deprecated
specifier|public
name|Iterator
argument_list|<
name|DocumentImpl
argument_list|>
name|iteratorNoLock
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|iteratorNoLock
argument_list|(
name|broker
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|List
argument_list|<
name|Collection
argument_list|>
name|getDescendants
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|Subject
name|user
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|getDescendants
argument_list|(
name|broker
argument_list|,
name|user
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|MutableDocumentSet
name|allDocs
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|MutableDocumentSet
name|docs
parameter_list|,
specifier|final
name|boolean
name|recursive
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
block|{
return|return
name|collection
operator|.
name|allDocs
argument_list|(
name|broker
argument_list|,
name|docs
argument_list|,
name|recursive
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|MutableDocumentSet
name|allDocs
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|MutableDocumentSet
name|docs
parameter_list|,
specifier|final
name|boolean
name|recursive
parameter_list|,
specifier|final
name|LockedDocumentMap
name|lockMap
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
block|{
return|return
name|collection
operator|.
name|allDocs
argument_list|(
name|broker
argument_list|,
name|docs
argument_list|,
name|recursive
argument_list|,
name|lockMap
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|DocumentSet
name|allDocs
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|MutableDocumentSet
name|docs
parameter_list|,
specifier|final
name|boolean
name|recursive
parameter_list|,
specifier|final
name|LockedDocumentMap
name|lockMap
parameter_list|,
specifier|final
name|Lock
operator|.
name|LockMode
name|lockType
parameter_list|)
throws|throws
name|LockException
throws|,
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|allDocs
argument_list|(
name|broker
argument_list|,
name|docs
argument_list|,
name|recursive
argument_list|,
name|lockMap
argument_list|,
name|lockType
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|DocumentSet
name|getDocuments
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|MutableDocumentSet
name|docs
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
block|{
return|return
name|collection
operator|.
name|getDocuments
argument_list|(
name|broker
argument_list|,
name|docs
argument_list|)
return|;
block|}
annotation|@
name|Override
annotation|@
name|Deprecated
specifier|public
name|DocumentSet
name|getDocumentsNoLock
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|MutableDocumentSet
name|docs
parameter_list|)
block|{
return|return
name|collection
operator|.
name|getDocumentsNoLock
argument_list|(
name|broker
argument_list|,
name|docs
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|DocumentSet
name|getDocuments
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|MutableDocumentSet
name|docs
parameter_list|,
specifier|final
name|LockedDocumentMap
name|lockMap
parameter_list|,
specifier|final
name|Lock
operator|.
name|LockMode
name|lockType
parameter_list|)
throws|throws
name|LockException
throws|,
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|getDocuments
argument_list|(
name|broker
argument_list|,
name|docs
argument_list|,
name|lockMap
argument_list|,
name|lockType
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|DocumentImpl
name|getDocument
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|getDocument
argument_list|(
name|broker
argument_list|,
name|name
argument_list|)
return|;
block|}
annotation|@
name|Override
annotation|@
name|Deprecated
specifier|public
name|LockedDocument
name|getDocumentWithLock
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|)
throws|throws
name|LockException
throws|,
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|getDocumentWithLock
argument_list|(
name|broker
argument_list|,
name|name
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|LockedDocument
name|getDocumentWithLock
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|,
specifier|final
name|Lock
operator|.
name|LockMode
name|lockMode
parameter_list|)
throws|throws
name|LockException
throws|,
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|getDocumentWithLock
argument_list|(
name|broker
argument_list|,
name|name
argument_list|,
name|lockMode
argument_list|)
return|;
block|}
annotation|@
name|Override
annotation|@
name|Deprecated
specifier|public
name|DocumentImpl
name|getDocumentNoLock
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|String
name|rawPath
parameter_list|)
throws|throws
name|PermissionDeniedException
block|{
return|return
name|collection
operator|.
name|getDocumentNoLock
argument_list|(
name|broker
argument_list|,
name|rawPath
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|removeCollection
parameter_list|(
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|)
throws|throws
name|LockException
throws|,
name|PermissionDeniedException
block|{
name|collection
operator|.
name|removeCollection
argument_list|(
name|broker
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|removeResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|DocumentImpl
name|doc
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|IOException
throws|,
name|TriggerException
block|{
name|collection
operator|.
name|removeResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|doc
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|removeXMLResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|TriggerException
throws|,
name|LockException
throws|,
name|IOException
block|{
name|collection
operator|.
name|removeXMLResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|removeBinaryResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|TriggerException
block|{
name|collection
operator|.
name|removeBinaryResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|removeBinaryResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|DocumentImpl
name|doc
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|TriggerException
block|{
name|collection
operator|.
name|removeBinaryResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|doc
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|IndexInfo
name|validateXMLResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|,
specifier|final
name|InputSource
name|source
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|TriggerException
throws|,
name|SAXException
throws|,
name|LockException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|validateXMLResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|,
name|source
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|IndexInfo
name|validateXMLResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|,
specifier|final
name|InputSource
name|source
parameter_list|,
specifier|final
name|XMLReader
name|reader
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|TriggerException
throws|,
name|SAXException
throws|,
name|LockException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|validateXMLResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|,
name|source
argument_list|,
name|reader
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|IndexInfo
name|validateXMLResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|,
specifier|final
name|String
name|data
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|TriggerException
throws|,
name|SAXException
throws|,
name|LockException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|validateXMLResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|,
name|data
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|IndexInfo
name|validateXMLResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|,
specifier|final
name|Node
name|node
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|TriggerException
throws|,
name|SAXException
throws|,
name|LockException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|validateXMLResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|,
name|node
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|store
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|IndexInfo
name|info
parameter_list|,
specifier|final
name|InputSource
name|source
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|TriggerException
throws|,
name|SAXException
throws|,
name|LockException
block|{
name|collection
operator|.
name|store
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|info
argument_list|,
name|source
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|store
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|IndexInfo
name|info
parameter_list|,
specifier|final
name|InputSource
name|source
parameter_list|,
specifier|final
name|XMLReader
name|reader
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|TriggerException
throws|,
name|SAXException
throws|,
name|LockException
block|{
name|collection
operator|.
name|store
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|info
argument_list|,
name|source
argument_list|,
name|reader
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|store
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|IndexInfo
name|info
parameter_list|,
specifier|final
name|String
name|data
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|TriggerException
throws|,
name|SAXException
throws|,
name|LockException
block|{
name|collection
operator|.
name|store
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|info
argument_list|,
name|data
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|store
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|IndexInfo
name|info
parameter_list|,
specifier|final
name|Node
name|node
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|TriggerException
throws|,
name|SAXException
throws|,
name|LockException
block|{
name|collection
operator|.
name|store
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|info
argument_list|,
name|node
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|BinaryDocument
name|validateBinaryResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|)
throws|throws
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|TriggerException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|validateBinaryResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|BinaryDocument
name|addBinaryResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|,
specifier|final
name|InputStream
name|is
parameter_list|,
specifier|final
name|String
name|mimeType
parameter_list|,
specifier|final
name|long
name|size
parameter_list|,
specifier|final
name|Date
name|created
parameter_list|,
specifier|final
name|Date
name|modified
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|TriggerException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|addBinaryResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|,
name|is
argument_list|,
name|mimeType
argument_list|,
name|size
argument_list|,
name|created
argument_list|,
name|modified
argument_list|)
return|;
block|}
annotation|@
name|Override
annotation|@
name|Deprecated
specifier|public
name|BinaryDocument
name|addBinaryResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|,
specifier|final
name|byte
index|[]
name|data
parameter_list|,
specifier|final
name|String
name|mimeType
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|TriggerException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|addBinaryResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|,
name|data
argument_list|,
name|mimeType
argument_list|)
return|;
block|}
annotation|@
name|Override
annotation|@
name|Deprecated
specifier|public
name|BinaryDocument
name|addBinaryResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|,
specifier|final
name|byte
index|[]
name|data
parameter_list|,
specifier|final
name|String
name|mimeType
parameter_list|,
specifier|final
name|Date
name|created
parameter_list|,
specifier|final
name|Date
name|modified
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|TriggerException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|addBinaryResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|,
name|data
argument_list|,
name|mimeType
argument_list|,
name|created
argument_list|,
name|modified
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|BinaryDocument
name|addBinaryResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|XmldbURI
name|name
parameter_list|,
specifier|final
name|InputStream
name|is
parameter_list|,
specifier|final
name|String
name|mimeType
parameter_list|,
specifier|final
name|long
name|size
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|TriggerException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|addBinaryResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|name
argument_list|,
name|is
argument_list|,
name|mimeType
argument_list|,
name|size
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|BinaryDocument
name|addBinaryResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|BinaryDocument
name|blob
parameter_list|,
specifier|final
name|InputStream
name|is
parameter_list|,
specifier|final
name|String
name|mimeType
parameter_list|,
specifier|final
name|long
name|size
parameter_list|,
specifier|final
name|Date
name|created
parameter_list|,
specifier|final
name|Date
name|modified
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|TriggerException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|addBinaryResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|blob
argument_list|,
name|is
argument_list|,
name|mimeType
argument_list|,
name|size
argument_list|,
name|created
argument_list|,
name|modified
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|BinaryDocument
name|addBinaryResource
parameter_list|(
specifier|final
name|Txn
name|transaction
parameter_list|,
specifier|final
name|DBBroker
name|broker
parameter_list|,
specifier|final
name|BinaryDocument
name|blob
parameter_list|,
specifier|final
name|InputStream
name|is
parameter_list|,
specifier|final
name|String
name|mimeType
parameter_list|,
specifier|final
name|long
name|size
parameter_list|,
specifier|final
name|Date
name|created
parameter_list|,
specifier|final
name|Date
name|modified
parameter_list|,
specifier|final
name|DBBroker
operator|.
name|PreserveType
name|preserve
parameter_list|)
throws|throws
name|EXistException
throws|,
name|PermissionDeniedException
throws|,
name|LockException
throws|,
name|TriggerException
throws|,
name|IOException
block|{
return|return
name|collection
operator|.
name|addBinaryResource
argument_list|(
name|transaction
argument_list|,
name|broker
argument_list|,
name|blob
argument_list|,
name|is
argument_list|,
name|mimeType
argument_list|,
name|size
argument_list|,
name|created
argument_list|,
name|modified
argument_list|,
name|preserve
argument_list|)
return|;
block|}
annotation|@
name|Override
specifier|public
name|Observable
name|getObservable
parameter_list|()
block|{
return|return
name|collection
operator|.
name|getObservable
argument_list|()
return|;
block|}
annotation|@
name|Override
specifier|public
name|void
name|serialize
parameter_list|(
specifier|final
name|VariableByteOutputStream
name|outputStream
parameter_list|)
throws|throws
name|IOException
throws|,
name|LockException
block|{
name|collection
operator|.
name|serialize
argument_list|(
name|outputStream
argument_list|)
expr_stmt|;
block|}
annotation|@
name|Override
specifier|public
name|int
name|compareTo
parameter_list|(
specifier|final
name|Collection
name|o
parameter_list|)
block|{
return|return
name|collection
operator|.
name|compareTo
argument_list|(
name|o
argument_list|)
return|;
block|}
block|}
end_class

end_unit

