<?xml version="1.0" encoding="UTF-8"?>

<!--
	This example uses the XMLDBTransformer to extract the title and
	creators for all books matching the first query.
-->
<document xmlns:ci="http://apache.org/cocoon/include/1.0">

	<!-- include header -->
    <ci:include src="context://header.xml"/>
       
    <!-- include sidebar -->
    <ci:include src="sidebar.xml"/>
   
  	<body>
  
    	<section title="Query results">
	    	<xml-source>
				<xmldb:collection 
					xmlns:xmldb="http://exist-db.org/transformer/1.0"
					uri="xmldb:exist:///db/test">
					<!-- iterate through all rdf:Description elements 
					containing "computer" -->
					<!--xmldb:for-each 
						query="//rdf:Description[dc:title &amp;= 'histor*']"
						from="0" to="9" sort-by="/dc:title"-->
					<xmldb:for-each
						query="/" from="0" to="9">
						<!-- output a book element -->
						<book>
							<!-- extract the title. There's only one title, so we use
								select-node. -->
							<title><xmldb:select-node query="dc:title/text()"/></title>
							<!-- extract the creators -->
							<xmldb:for-each query="dc:creator/text()">
								<creator><xmldb:current-node/></creator>
							</xmldb:for-each>
							<xmldb:current-node/>
						</book>
					</xmldb:for-each>
				</xmldb:collection>
			</xml-source>
		</section>
	</body>
</document>
