<?xml version="1.0" encoding="UTF-8"?>
<article>
    <articleinfo>
        <productname>Open Source Native XML Database</productname>
        <title>Building eXist</title>
        <author>
            <firstname>Wolfgang</firstname>
            <surname>Meier</surname>
            <email>wolfgang at exist-db.org</email>
        </author>
    </articleinfo>

    <ci:include xmlns:ci="http://apache.org/cocoon/include/1.0" src="sidebar.xml"/>

    <section>
        <title>Using the Build System</title>

        <para>You can rebuild all eXist packages from the standard distribution or the subversion
            repository. You can even create a new distribution from the one you installed. For
            example, assume you installed eXist using the installer GUI, but you need to have an
            exist.war package for deployment within a different servlet engine. Just call the main
            build script (<filename>build.sh</filename> or <filename>build.bat</filename>) and pass
            it the target <option>dist-war</option>:</para>

        <synopsis>build.sh dist-war</synopsis>

        <para>This will create a fresh <filename>.war</filename> archive in the
            <filename>dist</filename> directory.</para>

        <note>
            <para>To be able to use the build system, you need to include the "source" module when
                selecting installable packages in the installer GUI.</para>
        </note>

        <para>eXist relies on Ant for all compile and build tasks. Ant is included in the
            distribution (directory <filename>tools/ant</filename>). As already mentioned above,
            there are two shell scripts to start Ant: <filename>build.sh</filename> or
                <filename>build.bat</filename>. The shell scripts will take care to create a proper
            command line to launch Java with the Ant version included in the distribution.</para>

        <para>Calling Ant without further argument will compile the sources and create the main
            jar-files (<filename>exist.jar</filename>, <filename>exist-optional.jar</filename>,
                <filename>start.jar</filename>).</para>

        <synopsis>build.sh -projecthelp</synopsis>

        <para>lists the available build targets. Passing one of these as argument to ant will call
            execute the corresponding target. The main targets are:</para>

        <table>
            <title>Useful Build Targets</title>

            <tgroup cols="2">
                <tbody>
                    <row>
                        <entry>jar</entry>
                        <entry>The default: compiles the source and creates eXist's main jar
                        files</entry>
                    </row>
                    <row>
                        <entry>samples</entry>
                        <entry>Builds the examples and packs them into examples.jar</entry>
                    </row>
                    <row>
                        <entry>javadocs</entry>
                        <entry>Call javadoc to create the API docs</entry>
                    </row>
                    <row>
                        <entry>docs</entry>
                        <entry>Create a static HTML version of the documentation</entry>
                    </row>
                    <row>
                        <entry>dist-war</entry>
                        <entry>Packages eXist into a .war file for deployment within a servlet
                            engine</entry>
                    </row>
                    <row>
                        <entry>installer</entry>
                        <entry>Creates a new installer package based on IzPack</entry>
                    </row>
                    <row>
                        <entry>test</entry>
                        <entry>Runs all tests in the test suite. This may take several
                        minutes.</entry>
                    </row>
                    <row>
                        <entry>xquery</entry>
                        <entry>Regenerate the XQuery parser code with ANTLR (only required if you
                            change
                        <filename>src/org/exist/xquery/parser/XQuery.g</filename>).</entry>
                    </row>
                </tbody>
            </tgroup>
        </table>
    </section>

    <section>
        <title>Using the Subversion Repository</title>

        <para>Since spring 2006, the entire code base of eXist is managed by the <ulink
                url="http://sourceforge.net/svn/?group_id=17691">Subversion repository at
                Sourceforge</ulink>. Before that we used CVS, which had a few issues, especially due
            to the separation into a developer's and anonymous server. Using Subversion should be
            much simpler, faster and more reliable.</para>

        <para>Fortunately, you don't need to be a hardcore Java developer to use the SVN version of
            eXist. In general, we try to keep the development version in a consistent state. The
            code should always compile and run the test cases, though temporary failures are
            possible, especially while a larger update is in progress.</para>

        <para>The repository root URL is:</para>

        <synopsis>https://svn.sourceforge.net/svnroot/exist</synopsis>

        <important>
            <para>Please note you have to use https, not http.</para>
        </important>

        <para>The current development trunk is at:</para>

        <synopsis>https://svn.sourceforge.net/svnroot/exist/trunk/eXist-1.0</synopsis>

        <para>This is the URL you will normally use for a checkout of the main eXist development
            tree.</para>

        <section>
            <title>Checking Out from the Repository</title>

            <para>There are many Subversion clients to choose from. If you want to actively
                contribute to eXist or otherwise work on eXist's source code, we recommend to use
                eclipse to check out the sources (see below) and setup a project. Otherwise, you can
                use any other SVN client. On Linux, I prefer the plain command line. For example,
                the following command checks out the main development trunk into a directory called
                eXist-trunk:</para>

            <synopsis>svn co https://svn.sourceforge.net/svnroot/exist/trunk/eXist-1.0 eXist-trunk</synopsis>

            <para>A good choice on the Windows platform is <ulink
                    url="http://tortoisesvn.tigris.org/">Tortoise SVN</ulink>. Tortoise is an
                extension to the windows shell. The following screenshot shows the checkout dialog:</para>

            <screenshot><graphic fileref="resources/tortoise.png"/></screenshot>

            <para>The repository already contains project configuration files for eclipse, so
                setting up the project should be pretty simple: you normally don't need to change
                much in order to dive into the source code (though you may need some customizations
                to build and run directly from within eclipse).</para>

            <para>To access a Subversion repository from within eclipse, you need to install the
                    <ulink url="http://subclipse.tigris.org/">subclipse</ulink> plugin first! Please
                follow the <ulink url="http://subclipse.tigris.org/install.html">install
                    instructions</ulink> available there.</para>

            <para>Once you installed subclipse, change to the perspective: "SVN Repository
                Exploring". In the "SVN Repository" tab of the left view, right click into the empty
                space and select <guimenu>New</guimenu>, then <guimenu>Repository
                Location</guimenu>. In the appearing dialog, enter the URL of the eXist development
                trunk: </para>

            <screenshot><graphic fileref="resources/subclipse1.png"/></screenshot>

            <para>The URL will now be listed in the "SVN Repository" view. Right click the URL and
                select <guimenu>Checkout</guimenu>. A progress window appears, saying that eclipse
                is "getting remote info". Once it finished, you should see the following dialog:</para>

            <screenshot><graphic fileref="resources/subclipse2.png"/></screenshot>

            <para>Just press <guimenu>Finish</guimenu> unless you want to specify a different
                directory or checkout a certain tag.</para>
        </section>
    </section>
</article>
