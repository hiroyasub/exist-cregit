<?xml version="1.0" encoding="ISO-8859-1"?>
<!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure 1.2//EN" 
	"http://jetty.mortbay.org/configure_1_2.dtd">
<!-- =============================================================== -->
<!-- Configure the Jetty Server                                      -->
<!-- =============================================================== -->
<Configure class="org.mortbay.jetty.Server">
	<!-- =============================================================== -->
	<!-- Configure the Request Listeners                                 -->
	<!-- =============================================================== -->
	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
	<!-- Add and configure a HTTP listener to port 8080                       -->
	<!-- The default port can be changed using: java -Djetty.port=80     -->
	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
	<Call name="addListener">
		<Arg>
			<New class="org.mortbay.http.SocketListener">
				<Set name="Port">
					<SystemProperty name="jetty.port" default="8080"/>
				</Set>
				<Set name="MinThreads">1</Set>
				<Set name="MaxThreads">100</Set>
				<Set name="MaxIdleTimeMs">30000</Set>
				<Set name="LowResourcePersistTimeMs">5000</Set>
			</New>
		</Arg>
	</Call>
	<!-- =============================================================== -->
	<!-- Configure the Contexts                                          -->
	<!-- =============================================================== -->
	
	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
	<!-- Standard Jetty root webapp							   -->
	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
	<Call name="addWebApplications">
		<Arg></Arg>
		<Arg><SystemProperty name="jetty.home" default="."/>/webapps/</Arg>
		<Arg>org/mortbay/jetty/servlet/webdefault.xml</Arg>
		<Arg type="boolean">true</Arg>
	</Call>
	
	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
	<!-- Configure eXist webapp 								   -->
	<!-- - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -->
	<Call name="addWebApplication">
		<Arg>/exist</Arg>
		<Arg><SystemProperty name="exist.home" default=".."/>/webapp/</Arg>
		<Set name="extractWAR">false</Set>
		<Set name="defaultsDescriptor">
			org/mortbay/jetty/servlet/webdefault.xml</Set>
	</Call>
	
	<!-- =============================================================== -->
	<!-- Configure the Request Log                                       -->
	<!-- =============================================================== -->
	<Set name="RequestLog">
		<New class="org.mortbay.http.NCSARequestLog">
			<Arg><SystemProperty name="jetty.home" 
				default="."/>/logs/yyyy_mm_dd.request.log</Arg>
			<Set name="retainDays">90</Set>
			<Set name="append">true</Set>
			<Set name="extended">false</Set>
			<Set name="buffered">true</Set>
			<Set name="LogTimeZone">GMT</Set>
		</New>
	</Set>
	
	<Call name="addRealm">
		<Arg>
			<New class="org.mortbay.http.HashUserRealm">
				<Arg>eXist Database Admin Realm</Arg>
				<Arg><SystemProperty name="jetty.home" 
					default="."/>/etc/adminRealm.properties</Arg>
			</New>
		</Arg>
	</Call>
</Configure>
